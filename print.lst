(C)Copyright TOSHIBA CORPORATION 1993-2009  All rights reserved
Tue Jun 09 21:04:20 2020
TLCS-900 Relocatable Assembler (32) V2.2k  [Page     1]  print.lst
Runtime option : c:\Program Files (x86)\TOSHIBA\T900\bin\asm900.exe -Nb2 -O1 -g -l print.asm

Location  Object                           Ins        Line Source Statement

                                 +0          1           1 ;*****************************************
                                 +0          2           2 ;	Print functions 
                                 +0          3           3 ;*****************************************
                                 +0          4           4 	$MAXIMUM
                                 +0          5           5 	module print
                                 +0          6           6 
                                 +0          7           7 ;  ---------------------------------
                                 +0          8           8 ;	EXTERNAL LOOK UP
                                 +0          9           9 ;  ---------------------------------
                                 +0         10          10 	extern SYSTEM_CALL
                                 +0         11          11 ;  ---------------------------------
                                 +0         12          12 ;   EXTERNAL DEFINITION
                                 +0         13          13 ;  ---------------------------------
                                 +0         14          14 	public print_init,print_string,print_byte,print_word
                                 +0         15          15 
                                 +0         16          16 ;  ---------------------------------
                                 +0         17          17 ;	INCLUDE
                                 +0         18          18 ;  ---------------------------------
                                 +0         19          19 	$include "k1head.inc"
                                 +1          1          20 ;=======================================================
                                 +1          2          21 
                                 +1          3          22 ;		SYSTEM RELATED EQU
                                 +1          4          23 
                                 +1          5          24 ;=======================================================
                                 +1          6          25 
  00008000                       +1          7          26 DISP_CTL0		EQU	0x08000			;interrupt control register
                                 +1          8          27 
                                 +1          9          28 ;D7 : 1 = Vint allowed / 0 = not allowed
                                 +1         10          29 
                                 +1         11          30 ;D6 : 1 = Hint allowed / 0 = not allowed
                                 +1         12          31 
                                 +1         13          32 
                                 +1         14          33 
  00008010                       +1         15          34 STS_RG_ADD		EQU	0x08010			;2D status register (READ)
                                 +1         16          35 
                                 +1         17          36 ;D7 : 1 = character over / 0 = no character over
                                 +1         18          37 
                                 +1         19          38 ;D6 : 1 = while V blanking / 0 = while in display mode
                                 +1         20          39 
                                 +1         21          40 
                                 +1         22          41 
  00008012                       +1         23          42 LCD_CTR_ADD		EQU	0x08012			;2D control register
                                 +1         24          43 
                                 +1         25          44 ;D7 : 1 = screen color inverse display / 0 = normal display
                                 +1         26          45 
                                 +1         27          46 ;D2Å`D0 : outside window frame color CODE
                                 +1         28          47 
                                 +1         29          48 
                                 +1         30          49 
  00008118                       +1         31          50 BG_COLOR		EQU 0x08118			;Background color register
                                 +1         32          51 
                                 +1         33          52 ;D7`D6: BGON. D7 = 1, D6 = 0: Use specified BG color. Defaults to D7/D6 both 0
                                 +1         34          53 
                                 +1         35          54 ;D2`D0: BG color code
                                 +1         36          55 
                                 +1         37          56 
                                 +1         38          57 
                                 +1         39          58 
  000087E0                       +1         40          59 RESET_ADD		EQU	0X087E0			;2D software reset (WRITE)
                                 +1         41          60 
                                 +1         42          61 ;2D cicuit initialization with "52" write
                                 +1         43          62 
                                 +1         44          63 
                                 +1         45          64 
  000087FE                       +1         46          65 VERSION_ADD		EQU	0x087FE			;2D cicuit version (READ)
                                 +1         47          66 
                                 +1         48          67 ;D7 : 1 = white LCD panel /0 = balck LCD panel 
                                 +1         49          68 
                                 +1         50          69 ;D5Å`D0 : 2D circuit version
                                 +1         51          70 
                                 +1         52          71 
                                 +1         53          72 
                                 +1         54          73 
                                 +1         55          74 
                                 +1         56          75 ;=======================================================
                                 +1         57          76 
                                 +1         58          77 ;		CHARACTER EQU
                                 +1         59          78 
                                 +1         60          79 ;=======================================================
                                 +1         61          80 
  0000A000                       +1         62          81 CHR_VRAM		EQU	0x0A000			;character data RAM address
                                 +1         63          82 
                                 +1         64          83 
                                 +1         65          84 
                                 +1         66          85 
                                 +1         67          86 
                                 +1         68          87 ;=======================================================
                                 +1         69          88 
                                 +1         70          89 ;		SCROLL EQU
                                 +1         71          90 
                                 +1         72          91 ;=======================================================
                                 +1         73          92 
  00009000                       +1         74          93 SCRL1_VRAM		EQU	0x09000
                                 +1         75          94 
  00009800                       +1         76          95 SCRL2_VRAM		EQU	0x09800
                                 +1         77          96 
                                 +1         78          97 
                                 +1         79          98 
  00008030                       +1         80          99 SCRL_PRIO_ADR		EQU	0X08030			;scroll priority level invert register 
                                 +1         81         100 
  00008032                       +1         82         101 SCRL_X1_ADR		EQU	0x08032			;scroll 1 offset H register
                                 +1         83         102 
  00008033                       +1         84         103 SCRL_Y1_ADR		EQU	0x08033			;scroll 1 offset V register
                                 +1         85         104 
  00008034                       +1         86         105 SCRL_X2_ADR		EQU	0x08034			;scroll 2 offset H register
                                 +1         87         106 
  00008035                       +1         88         107 SCRL_Y2_ADR		EQU	0x08035			;scroll 2 offset V register
                                 +1         89         108 
                                 +1         90         109 
                                 +1         91         110 
                                 +1         92         111 ;=======================================================
                                 +1         93         112 
                                 +1         94         113 ;		SPRITE EQU
                                 +1         95         114 
                                 +1         96         115 ;=======================================================
                                 +1         97         116 
  00008800                       +1         98         117 SPR_VRAM		EQU	0x08800
                                 +1         99         118 
  00008020                       +1        100         119 SPR_OFFSET_X_ADR	EQU	0x08020			;sprite offset H
                                 +1        101         120 
  00008021                       +1        102         121 SPR_OFFSET_Y_ADR	EQU	0x08021			;sprite offset V
                                 +1        103         122 
  00008C00                       +1        104         123 SPR_PALCODE EQU 0x8C00 ;what palette # to use for each sprite 
                                 +1        105         124 
                                 +1        106         125 
                                 +1        107         126 
                                 +1        108         127 
                                 +1        109         128 ;=======================================================
                                 +1        110         129 
                                 +1        111         130 ;		WINDOW SYSTEM EQU
                                 +1        112         131 
                                 +1        113         132 ;=======================================================
                                 +1        114         133 
  00008002                       +1        115         134 WIN_WBAX_ADR		EQU	0x08002			;window origin H
                                 +1        116         135 
  00008003                       +1        117         136 WIN_WBAY_ADR		EQU	0x08003			;window origin V
                                 +1        118         137 
  00008004                       +1        119         138 WIN_WSIX_ADR		EQU	0x08004			;window size H
                                 +1        120         139 
  00008005                       +1        121         140 WIN_WSIY_ADR		EQU	0x08005			;window size V
                                 +1        122         141 
                                 +1        123         142 
                                 +1        124         143 
  00008008                       +1        125         144 WD_LCDST_HPOS		EQU	0x08008			;raster H position register (READ)
                                 +1        126         145 
  00008009                       +1        127         146 WD_LCDST_VPOS		EQU	0x08009			;raster V position register (READ)
                                 +1        128         147 
                                 +1        129         148 
                                 +1        130         149 
                                 +1        131         150 ;=======================================================
                                 +1        132         151 
                                 +1        133         152 ;		PALETTE EQU
                                 +1        134         153 
                                 +1        135         154 ;=======================================================
                                 +1        136         155 
                                 +1        137         156 ;sprite palette 0
                                 +1        138         157 
  00008101                       +1        139         158 PL_SPR_00		EQU	0x08101	
                                 +1        140         159 
  00008102                       +1        141         160 PL_SPR_01		EQU	0x08102
                                 +1        142         161 
  00008103                       +1        143         162 PL_SPR_02		EQU	0x08103
                                 +1        144         163 
                                 +1        145         164 ;sprite palette 1
                                 +1        146         165 
  00008105                       +1        147         166 PL_SPR_10		EQU	0x08105
                                 +1        148         167 
  00008106                       +1        149         168 PL_SPR_11		EQU	0x08106
                                 +1        150         169 
  00008107                       +1        151         170 PL_SPR_12		EQU	0x08107
                                 +1        152         171 
                                 +1        153         172 
                                 +1        154         173 
                                 +1        155         174 ;scroll 0 palette 0
                                 +1        156         175 
  00008109                       +1        157         176 PL_SCR0_00		EQU	0x08109
                                 +1        158         177 
  0000810A                       +1        159         178 PL_SCR0_01		EQU	0x0810A
                                 +1        160         179 
  0000810B                       +1        161         180 PL_SCR0_02		EQU	0x0810B
                                 +1        162         181 
                                 +1        163         182 ;scroll 0 palette 1
                                 +1        164         183 
  0000810D                       +1        165         184 PL_SCR0_10		EQU	0x0810D
                                 +1        166         185 
  0000810E                       +1        167         186 PL_SCR0_11		EQU	0x0810E
                                 +1        168         187 
  0000810F                       +1        169         188 PL_SCR0_12		EQU	0x0810F
                                 +1        170         189 
                                 +1        171         190 ;scroll 1 palette 0
                                 +1        172         191 
  00008111                       +1        173         192 PAL_SCR1_00		EQU	0x08111
                                 +1        174         193 
  00008112                       +1        175         194 PAL_SCR1_01		EQU	0x08112
                                 +1        176         195 
  00008113                       +1        177         196 PAL_SCR1_02		EQU	0x08113
                                 +1        178         197 
                                 +1        179         198 ;scroll 1 palette 1
                                 +1        180         199 
  00008115                       +1        181         200 PAL_SCR1_10		EQU	0x08115
                                 +1        182         201 
  00008116                       +1        183         202 PAL_SCR1_11		EQU	0x08116
                                 +1        184         203 
  00008117                       +1        185         204 PAL_SCR1_12		EQU	0x08117
                                 +1        186         205 
                                 +1        187         206 
                                 +1        188         207 ;=======================================================
                                 +1        189         208 
                                 +1        190         209 ;		COLOR PALETTE RAM EQU
                                 +1        191         210 
                                 +1        192         211 ;=======================================================
                                 +1        193         212 
  00008200                       +1        194         213 SPRITE_CRAM		EQU 0x08200
                                 +1        195         214 
  00008280                       +1        196         215 SCROLL1_CRAM	EQU 0x08280
                                 +1        197         216 
  00008300                       +1        198         217 SCROLL2_CRAM	EQU 0x08300
                                 +1        199         218 
  000083E0                       +1        200         219 BGCOL_CRAM		EQU 0x083E0 ;for the background color
                                 +1        201         220 
  000083F0                       +1        202         221 WINDOW_CRAM		EQU 0x083F0
                                 +1        203         222 
                                 +1        204         223 
                                 +1        205         224 ;=======================================================
                                 +1        206         225 
                                 +1        207         226 ;		TIMER EQU
                                 +1        208         227 
                                 +1        209         228 ;=======================================================
                                 +1        210         229 
  00000020                       +1        211         230 T8RUN	EQU 0x0020 ;bitmask controlling 8 bit timers
                                 +1        212         231 
                                 +1        213         232 
                                 +1        214         233 
                                 +1        215         234 ;=======================================================
                                 +0         20         235 	$include "system.inc"
                                 +1          1         236 ;-----------------------------------------------------------------
                                 +1          2         237 
                                 +1          3         238 ;	SYSTEM CALL
                                 +1          4         239 
                                 +1          5         240 ;-----------------------------------------------------------------
                                 +1          6         241 
  00000000                       +1          7         242 SYS_SUCCESS		equ	0x00			;run success
                                 +1          8         243 
  000000FF                       +1          9         244 SYS_FAILURE		equ	0xff			;run failure
                                 +1         10         245 
                                 +1         11         246 ;-----------------------------------------------------------------
                                 +1         12         247 
  00000000                       +1         13         248 VECT_SHUTDOWN		equ	0x00			;shutdown (power OFF)
                                 +1         14         249 
  00000001                       +1         15         250 VECT_CLOCKGEARSET	equ	0x01			;clock gear change
                                 +1         16         251 
  00000002                       +1         17         252 VECT_RTCGET		equ	0x02			;obtain time
                                 +1         18         253 
  00000004                       +1         19         254 VECT_INTLVSET		equ	0x04			;set interrupt level
                                 +1         20         255 
  00000005                       +1         21         256 VECT_SYSFONTSET	equ	0x05			;set system font
                                 +1         22         257 
  00000006                       +1         23         258 VECT_FLASHWRITE	equ	0x06			;flash memory data write
                                 +1         24         259 
  00000007                       +1         25         260 VECT_FLASHALLERS	equ	0x07			;flash memory erase all blocks
                                 +1         26         261 
  00000008                       +1         27         262 VECT_FLASHERS		equ	0x08			;flash memory erase specified blocks
                                 +1         28         263 
  00000009                       +1         29         264 VECT_ALARMSET		equ	0x09			;game alarm setting
                                 +1         30         265 
  0000000B                       +1         31         266 VECT_ALARMDOWNSET	equ	0x0b			;alarm setting during shutdown
                                 +1         32         267 
  0000000D                       +1         33         268 VECT_FLASHPROTECT	equ	0x0d			;protect using tool
                                 +1         34         269 
  0000000E                       +1         35         270 VECT_GEMODESET	equ	0x0e			;switching GE mode
                                 +1         36         271 
                                 +1         37         272 ;-----------------------------------------------------------------
                                 +1         38         273 
                                 +1         39         274 ;	SYSTEM BIT EQU
                                 +1         40         275 
                                 +1         41         276 ;-----------------------------------------------------------------
                                 +1         42         277 
  00000007                       +1         43         278 INT_CLR_BIT		equ	0x07			;interrupt request clear bit
                                 +1         44         279 
  00000080                       +1         45         280 _INT_CLR_BIT		equ	0y10000000		;
                                 +1         46         281 
                                 +1         47         282 ;-----------------------------------------------------------------
                                 +1         48         283 
                                 +1         49         284 ;	SYSTEM WORK
                                 +1         50         285 
                                 +1         51         286 ;-----------------------------------------------------------------
                                 +1         52         287 
  00006F80                       +1         53         288 Battery_Voltage	equ	0x6f80			;estimated voltage
                                 +1         54         289 
  00006F82                       +1         55         290 Sys_lever		equ	0x6f82			;lever value
                                 +1         56         291 
  00006F87                       +1         57         292 Language		equ	0x6f87			;language chosen
                                 +1         58         293 
  00006F85                       +1         59         294 User_Shutdown		equ	0x6f85			;shutdown re1uest bit
                                 +1         60         295 
  00006F84                       +1         61         296 User_Boot		equ	0x6f84			;startup bit flag
                                 +1         62         297 
  00006F86                       +1         63         298 User_Answer		equ	0x6f86			;user request bit
                                 +1         64         299 
  00006F91                       +1         65         300 OS_Version		equ	0x6f91			;system version reserve work
                                 +1         66         301 
                                 +1         67         302 ;-----------------------------------------------------------------
                                 +1         68         303 
                                 +1         69         304 ;	WATCH DOG
                                 +1         70         305 
                                 +1         71         306 ;-----------------------------------------------------------------
                                 +1         72         307 
  0000006F                       +1         73         308 WDCR			equ	0x06F		;watch dog control address
                                 +1         74         309 
  0000004E                       +1         75         310 WD_CLR			equ	0x04e		;watch dog clear code
                                 +1         76         311 
                                 +1         77         312 ;-----------------------------------------------------------------
                                 +1         78         313 
                                 +1         79         314 ;	SYSTEM WORK BIT
                                 +1         80         315 
                                 +1         81         316 ;-----------------------------------------------------------------
                                 +1         82         317 
  00000001                       +1         83         318 JOY_UP 		equ 0x1
  00000002                       +1         84         319 JOY_DOWN 	equ 0x2
  00000004                       +1         85         320 JOY_LEFT 	equ 0x4
  00000008                       +1         86         321 JOY_RIGHT 	equ 0x8
  00000010                       +1         87         322 JOY_A		equ 0x10
  00000020                       +1         88         323 JOY_B		equ 0x20
  00000040                       +1         89         324 JOY_OPTION	equ 0x40
                                 +1         90         325 
  00000000                       +1         91         326 BIT_UP		equ 0
  00000001                       +1         92         327 BIT_DOWN	equ 1
  00000002                       +1         93         328 BIT_LEFT	equ 2
  00000003                       +1         94         329 BIT_RIGHT	equ 3
  00000004                       +1         95         330 BIT_A		equ 4
  00000005                       +1         96         331 BIT_B		equ 5
  00000006                       +1         97         332 BIT_OPTION	equ 6
                                 +1         98         333 
                                 +1         99         334 ;======================================================= 
                                 +1        100         335 
                                 +1        101         336 ;	USER START UP BIT
                                 +1        102         337 
                                 +1        103         338 ;======================================================= 
                                 +1        104         339 
                                 +1        105         340 ;User_Boot
                                 +1        106         341 
                                 +1        107         342 ;	00000000
                                 +1        108         343 
                                 +1        109         344 ;	||+------ resume startup			0:not resume startup		1:resume startup
                                 +1        110         345 
                                 +1        111         346 ;	|+------- POWER startup			0:not POWER startup		1:POWER startup
                                 +1        112         347 
                                 +1        113         348 ;	+-------- alarm startup			0:not alarm statup		1:alarm statup
                                 +1        114         349 
                                 +1        115         350 ;	=================================================
                                 +1        116         351 
                                 +1        117         352 
                                 +1        118         353 
  00000007                       +1        119         354 ALARM_BOOT_REQ		equ	0x07
                                 +1        120         355 
  00000006                       +1        121         356 POWER_BOOT_REQ		equ	0x06
                                 +1        122         357 
  00000005                       +1        123         358 RESUME_BOOT_REQ		equ	0x05
                                 +1        124         359 
  00000080                       +1        125         360 _ALARM_BOOT_REQ		equ	0y10000000
                                 +1        126         361 
  00000040                       +1        127         362 _POWER_BOOT_REQ		equ	0y01000000
                                 +1        128         363 
  00000020                       +1        129         364 _RESUME_BOOT_REQ	equ	0y00100000
                                 +1        130         365 
                                 +1        131         366 
                                 +1        132         367 
                                 +1        133         368 ;======================================================= 
                                 +1        134         369 
                                 +1        135         370 ;	USER SHUTDOWN BIT
                                 +1        136         371 
                                 +1        137         372 ;======================================================= 
                                 +1        138         373 
                                 +1        139         374 ;User_Shutdown
                                 +1        140         375 
                                 +1        141         376 ;	00000000
                                 +1        142         377 
                                 +1        143         378 ;	||+--------- main power use shutdown request	0:no request	1:request
                                 +1        144         379 
                                 +1        145         380 ;	|+---------- no use shutdown request		0:no request	1:request
                                 +1        146         381 
                                 +1        147         382 ;	+----------- power off shutdown request		0:no request	1:request
                                 +1        148         383 
                                 +1        149         384 ;	=================================================
                                 +1        150         385 
                                 +1        151         386 
                                 +1        152         387 
  00000007                       +1        153         388 MP_SHUTDOWN_REQ	equ	0x07
                                 +1        154         389 
  00000006                       +1        155         390 TIME_SHUTDOWN_REQ	equ	0x06
                                 +1        156         391 
  00000005                       +1        157         392 BAT_SHUTDOWN_REQ	equ	0x05
                                 +1        158         393 
  00000080                       +1        159         394 _MP_SHUTDOWN_REQ	equ	0y10000000
                                 +1        160         395 
  00000040                       +1        161         396 _TIME_SHUTDOWN_REQ	equ	0y01000000
                                 +1        162         397 
  00000020                       +1        163         398 _BAT_SHUTDOWN_REQ	equ	0y00100000
                                 +1        164         399 
                                 +1        165         400 
                                 +1        166         401 
                                 +1        167         402 ;======================================================= 
                                 +1        168         403 
                                 +1        169         404 ;	USER ANSWER BIT
                                 +1        170         405 
                                 +1        171         406 ;======================================================= 
                                 +1        172         407 
                                 +1        173         408 ;User_Answer
                                 +1        174         409 
                                 +1        175         410 ;	00000000
                                 +1        176         411 
                                 +1        177         412 ;	|+----------- no use shutdown operation	0:non-existent	1:exists
                                 +1        178         413 
                                 +1        179         414 ;	+------------ resume operation		0:non-existent	1:exists
                                 +1        180         415 
                                 +1        181         416 ;	=================================================
                                 +1        182         417 
                                 +1        183         418 
                                 +1        184         419 
  00000007                       +1        185         420 RESUME_ANS		equ	0x07
                                 +1        186         421 
  00000006                       +1        187         422 TIMER_SHUTDOWN_ANS	equ	0x06
                                 +1        188         423 
  00000080                       +1        189         424 _RESUME_ANS		equ	0y10000000
                                 +1        190         425 
  00000040                       +1        191         426 _TIMER_SHUTDOWN_ANS	equ	0y01000000
                                 +1        192         427 
                                 +0         21         428 
                                 +0         22         429 ;-------------------------------------------------------
                                 +0         23         430 PROG section code large
                                 +0         24         431 ;-------------------------------------------------------
                                 +0         25         432 
                                 +0         26         433 ;-------------------------------------------------------
                                 +0         27         434 ; print_init: loads system font into first half of vram
                                 +0         28         435 ;-------------------------------------------------------
00000000                         +0         29         436 print_init:
00000000  C730AB                 +0         30         437 	ldb	ra3,3
00000003  C731AD                 +0         31         438 	ldb	rw3,VECT_SYSFONTSET
00000006  1D000000             R +0         32         439 	cal	SYSTEM_CALL
0000000A  0E                     +0         33         440 	ret
                                 +0         34         441 
                                 +0         35         442 ;-------------------------------------------------------
                                 +0         36         443 ; print_string
                                 +0         37         444 ;-------------------------------------------------------
                                 +0         38         445 ; xix: pointer to null terminated text
                                 +0         39         446 ; wa: x pos
                                 +0         40         447 ; bc: y pos
                                 +0         41         448 ;-------------------------------------------------------
0000000B                         +0         42         449 print_string:
                                 +0         43         450 	;calculate screen offset
0000000B  F1009035               +0         44         451 	lda xiy,SCRL1_VRAM
0000000F  D8EC01                 +0         45         452 	slaw 1,wa ;2 bytes per tile
00000012  D9EC06                 +0         46         453 	slaw 6,bc ;each column is 0x40 bytes
00000015  D885                   +0         47         454 	addw iy,wa
00000017  D985                   +0         48         455 	addw iy,bc
00000019                         +0         49         456 copy_text:
00000019  C5F021                 +0         50         457 	ldb a,(xix+)
0000001C  C9C1                   +0         51         458 	andb a,a
0000001E  6609                   +0         52         459 	j z,done_copy_text
00000020  F5F441                 +0         53         460 	ldb (xiy+),a
00000023  F5F40000               +0         54         461 	ldb (xiy+),0
00000027  68F0                   +0         55         462 	j copy_text
00000029                         +0         56         463 done_copy_text:
00000029  0E                     +0         57         464 	ret
                                 +0         58         465 	
                                 +0         59         466 ;-------------------------------------------------------
                                 +0         60         467 ; print_byte
                                 +0         61         468 ;-------------------------------------------------------
                                 +0         62         469 ; xix: pointer to byte to print
                                 +0         63         470 ; wa: x pos
                                 +0         64         471 ; bc: y pos
                                 +0         65         472 ;-------------------------------------------------------
0000002A                         +0         66         473 print_byte:
                                 +0         67         474 	;calculate screen offset
0000002A  F1009035               +0         68         475 	lda xiy,SCRL1_VRAM
0000002E  D8EC01                 +0         69         476 	slaw 1,wa ;2 bytes per tile
00000031  D9EC06                 +0         70         477 	slaw 6,bc ;each column is 0x40 bytes
00000034  D885                   +0         71         478 	addw iy,wa
00000036  D985                   +0         72         479 	addw iy,bc
                                 +0         73         480 	;---first nybble---
00000038  8421                   +0         74         481 	ldb a,(xix)
0000003A  C98A                   +0         75         482 	ldb b,a
0000003C  CACCF0                 +0         76         483 	andb b,0xf0 ;isolate high nybble
0000003F  CAEF04                 +0         77         484 	srlb 4,b
00000042  CACF0A                 +0         78         485 	cpb b,0xa
00000045  6F05                   +0         79         486 	j nc,byte_atf0
00000047  CAC830                 +0         80         487 	addb b,0x30 ;if nybble between 0 and 9, add 0x30
0000004A  6803                   +0         81         488 	j byte_doneadd0
0000004C                         +0         82         489 byte_atf0: ;if nybble between a and f, add 0x37
0000004C  CAC837                 +0         83         490 	addb b,0x37
0000004F                         +0         84         491 byte_doneadd0:
0000004F  F5F442                 +0         85         492 	ldb (xiy+),b
00000052  F5F40000               +0         86         493 	ldb (xiy+),0
                                 +0         87         494 	;---second nybble---
00000056  C98A                   +0         88         495 	ldb b,a
00000058  CACC0F                 +0         89         496 	andb b,0xf ;isolate low nybble
0000005B  CACF0A                 +0         90         497 	cpb b,0xa
0000005E  6F05                   +0         91         498 	j nc,byte_atf1
00000060  CAC830                 +0         92         499 	addb b,0x30 ;if nybble between 0 and 9, add 0x30
00000063  6803                   +0         93         500 	j byte_doneadd1
00000065                         +0         94         501 byte_atf1: ;if nybble between a and f, add 0x37
00000065  CAC837                 +0         95         502 	addb b,0x37
00000068                         +0         96         503 byte_doneadd1:
00000068  F5F442                 +0         97         504 	ldb (xiy+),b
0000006B  F5F40000               +0         98         505 	ldb (xiy+),0
0000006F  0E                     +0         99         506 	ret
                                 +0        100         507 
                                 +0        101         508 ;-------------------------------------------------------
                                 +0        102         509 ; print_word	
                                 +0        103         510 ;-------------------------------------------------------
                                 +0        104         511 ; xix: pointer to word to print
                                 +0        105         512 ; wa: x pos
                                 +0        106         513 ; bc: y pos
                                 +0        107         514 ;-------------------------------------------------------
00000070                         +0        108         515 print_word:
                                 +0        109         516 	;calculate screen offset
00000070  F1009035               +0        110         517 	lda xiy,SCRL1_VRAM
00000074  D8EC01                 +0        111         518 	slaw 1,wa ;2 bytes per tile
00000077  D9EC06                 +0        112         519 	slaw 6,bc ;each column is 0x40 bytes
0000007A  D885                   +0        113         520 	addw iy,wa
0000007C  D985                   +0        114         521 	addw iy,bc
                                 +0        115         522 	;---first nybble---
0000007E  9420                   +0        116         523 	ldw wa,(xix)
00000080  C88A                   +0        117         524 	ldb b,w
00000082  CACCF0                 +0        118         525 	andb b,0xf0 ;isolate high nybble
00000085  CAEF04                 +0        119         526 	srlb 4,b
00000088  CACF0A                 +0        120         527 	cpb b,0xa
0000008B  6F05                   +0        121         528 	j nc,word_atf0
0000008D  CAC830                 +0        122         529 	addb b,0x30 ;if nybble between 0 and 9, add 0x30
00000090  6803                   +0        123         530 	j word_doneadd0
00000092                         +0        124         531 word_atf0: ;if nybble between a and f, add 0x37
00000092  CAC837                 +0        125         532 	addb b,0x37
00000095                         +0        126         533 word_doneadd0:
00000095  F5F442                 +0        127         534 	ldb (xiy+),b
00000098  F5F40000               +0        128         535 	ldb (xiy+),0
                                 +0        129         536 	;---second nybble---
0000009C  C88A                   +0        130         537 	ldb b,w
0000009E  CACC0F                 +0        131         538 	andb b,0xf ;isolate low nybble
000000A1  CACF0A                 +0        132         539 	cpb b,0xa
000000A4  6F05                   +0        133         540 	j nc,word_atf1
000000A6  CAC830                 +0        134         541 	addb b,0x30 ;if nybble between 0 and 9, add 0x30
000000A9  6803                   +0        135         542 	j word_doneadd1
000000AB                         +0        136         543 word_atf1: ;if nybble between a and f, add 0x37
000000AB  CAC837                 +0        137         544 	addb b,0x37
000000AE                         +0        138         545 word_doneadd1:
000000AE  F5F442                 +0        139         546 	ldb (xiy+),b
000000B1  F5F40000               +0        140         547 	ldb (xiy+),0
                                 +0        141         548 	;---third nybble
000000B5  C5F021                 +0        142         549 	ldb a,(xix+)
000000B8  C98A                   +0        143         550 	ldb b,a
000000BA  CACCF0                 +0        144         551 	andb b,0xf0 ;isolate high nybble
000000BD  CAEF04                 +0        145         552 	srlb 4,b
000000C0  CACF0A                 +0        146         553 	cpb b,0xa
000000C3  6F05                   +0        147         554 	j nc,word_atf2
000000C5  CAC830                 +0        148         555 	addb b,0x30 ;if nybble between 0 and 9, add 0x30
000000C8  6803                   +0        149         556 	j word_doneadd2
000000CA                         +0        150         557 word_atf2: ;if nybble between a and f, add 0x37
000000CA  CAC837                 +0        151         558 	addb b,0x37
000000CD                         +0        152         559 word_doneadd2:
000000CD  F5F442                 +0        153         560 	ldb (xiy+),b
000000D0  F5F40000               +0        154         561 	ldb (xiy+),0
                                 +0        155         562 	;---fourth nybble---
000000D4  C98A                   +0        156         563 	ldb b,a
000000D6  CACC0F                 +0        157         564 	andb b,0xf ;isolate low nybble
000000D9  CACF0A                 +0        158         565 	cpb b,0xa
000000DC  6F05                   +0        159         566 	j nc,word_atf3
000000DE  CAC830                 +0        160         567 	addb b,0x30 ;if nybble between 0 and 9, add 0x30
000000E1  6803                   +0        161         568 	j word_doneadd3
000000E3                         +0        162         569 word_atf3: ;if nybble between a and f, add 0x37
000000E3  CAC837                 +0        163         570 	addb b,0x37
000000E6                         +0        164         571 word_doneadd3:
000000E6  F5F442                 +0        165         572 	ldb (xiy+),b
000000E9  F5F40000               +0        166         573 	ldb (xiy+),0	
000000ED  0E                     +0        167         574 	ret	
                                 +0        168         575 
                                 +0        169         576 ;-------------------------------------------------------
                                 +0        170         577 	end
                                 +0        171         578 ;-------------------------------------------------------

Assembly complete, No error
TLCS-900 Relocatable Assembler (32) V2.2k  [Page     2]  print.lst

Symbol table listing
--------------------

Symbol           Category         Value     Attribute

ALARM_BOOT_REQ           NUM      00000007  A           
BAT_SHUTDOWN_REQ
                         NUM      00000005  A           
BGCOL_CRAM               NUM      000083E0  A           
BG_COLOR                 NUM      00008118  A           
BIT_A                    NUM      00000004  A           
BIT_B                    NUM      00000005  A           
BIT_DOWN                 NUM      00000001  A           
BIT_LEFT                 NUM      00000002  A           
BIT_OPTION               NUM      00000006  A           
BIT_RIGHT                NUM      00000003  A           
BIT_UP                   NUM      00000000  A           
Battery_Voltage          NUM      00006F80  A           
CHR_VRAM                 NUM      0000A000  A           
DISP_CTL0                NUM      00008000  A           
INT_CLR_BIT              NUM      00000007  A           
JOY_A                    NUM      00000010  A           
JOY_B                    NUM      00000020  A           
JOY_DOWN                 NUM      00000002  A           
JOY_LEFT                 NUM      00000004  A           
JOY_OPTION               NUM      00000040  A           
JOY_RIGHT                NUM      00000008  A           
JOY_UP                   NUM      00000001  A           
LCD_CTR_ADD              NUM      00008012  A           
Language                 NUM      00006F87  A           
MP_SHUTDOWN_REQ          NUM      00000007  A           
OS_Version               NUM      00006F91  A           
PAL_SCR1_00              NUM      00008111  A           
PAL_SCR1_01              NUM      00008112  A           
PAL_SCR1_02              NUM      00008113  A           
PAL_SCR1_10              NUM      00008115  A           
PAL_SCR1_11              NUM      00008116  A           
PAL_SCR1_12              NUM      00008117  A           
PL_SCR0_00               NUM      00008109  A           
PL_SCR0_01               NUM      0000810A  A           
PL_SCR0_02               NUM      0000810B  A           
PL_SCR0_10               NUM      0000810D  A           
PL_SCR0_11               NUM      0000810E  A           
PL_SCR0_12               NUM      0000810F  A           
PL_SPR_00                NUM      00008101  A           
PL_SPR_01                NUM      00008102  A           
PL_SPR_02                NUM      00008103  A           
PL_SPR_10                NUM      00008105  A           
PL_SPR_11                NUM      00008106  A           
PL_SPR_12                NUM      00008107  A           
POWER_BOOT_REQ           NUM      00000006  A           
PROG             C L     SEC      00000000  R EE        
RESET_ADD                NUM      000087E0  A           
RESUME_ANS               NUM      00000007  A           
RESUME_BOOT_REQ          NUM      00000005  A           
SCRL1_VRAM               NUM      00009000  A           
SCRL2_VRAM               NUM      00009800  A           
SCRL_PRIO_ADR            NUM      00008030  A           
SCRL_X1_ADR              NUM      00008032  A           
SCRL_X2_ADR              NUM      00008034  A           
SCRL_Y1_ADR              NUM      00008033  A           
SCRL_Y2_ADR              NUM      00008035  A           
SCROLL1_CRAM             NUM      00008280  A           
SCROLL2_CRAM             NUM      00008300  A           
SPRITE_CRAM              NUM      00008200  A           
SPR_OFFSET_X_ADR
                         NUM      00008020  A           
SPR_OFFSET_Y_ADR
                         NUM      00008021  A           
SPR_PALCODE              NUM      00008C00  A           
SPR_VRAM                 NUM      00008800  A           
STS_RG_ADD               NUM      00008010  A           
SYSTEM_CALL                       00000000  R EXT       
SYS_FAILURE              NUM      000000FF  A           
SYS_SUCCESS              NUM      00000000  A           
Sys_lever                NUM      00006F82  A           
T8RUN                    NUM      00000020  A           
TIMER_SHUTDOWN_ANS
                         NUM      00000006  A           
TIME_SHUTDOWN_REQ
                         NUM      00000006  A           
User_Answer              NUM      00006F86  A           
User_Boot                NUM      00006F84  A           
User_Shutdown            NUM      00006F85  A           
VECT_ALARMDOWNSET
                         NUM      0000000B  A           
VECT_ALARMSET            NUM      00000009  A           
VECT_CLOCKGEARSET
                         NUM      00000001  A           
VECT_FLASHALLERS
                         NUM      00000007  A           
VECT_FLASHERS            NUM      00000008  A           
VECT_FLASHPROTECT
                         NUM      0000000D  A           
VECT_FLASHWRITE          NUM      00000006  A           
VECT_GEMODESET           NUM      0000000E  A           
VECT_INTLVSET            NUM      00000004  A           
VECT_RTCGET              NUM      00000002  A           
VECT_SHUTDOWN            NUM      00000000  A           
VECT_SYSFONTSET          NUM      00000005  A           
VERSION_ADD              NUM      000087FE  A           
WDCR                     NUM      0000006F  A           
WD_CLR                   NUM      0000004E  A           
WD_LCDST_HPOS            NUM      00008008  A           
WD_LCDST_VPOS            NUM      00008009  A           
WINDOW_CRAM              NUM      000083F0  A           
WIN_WBAX_ADR             NUM      00008002  A           
WIN_WBAY_ADR             NUM      00008003  A           
WIN_WSIX_ADR             NUM      00008004  A           
WIN_WSIY_ADR             NUM      00008005  A           
_ALARM_BOOT_REQ          NUM      00000080  A           
_BAT_SHUTDOWN_REQ
                         NUM      00000020  A           
_INT_CLR_BIT             NUM      00000080  A           
_MP_SHUTDOWN_REQ
                         NUM      00000080  A           
_POWER_BOOT_REQ          NUM      00000040  A           
_RESUME_ANS              NUM      00000080  A           
_RESUME_BOOT_REQ
                         NUM      00000020  A           
_TIMER_SHUTDOWN_ANS
                         NUM      00000040  A           
_TIME_SHUTDOWN_REQ
                         NUM      00000040  A           
byte_atf0        C L     LAB      0000004C  R           PROG
byte_atf1        C L     LAB      00000065  R           PROG
byte_doneadd0    C L     LAB      0000004F  R           PROG
byte_doneadd1    C L     LAB      00000068  R           PROG
copy_text        C L     LAB      00000019  R           PROG
done_copy_text   C L     LAB      00000029  R           PROG
print                    MOD
print_byte       C L     LAB      0000002A  R PUB       PROG
print_init       C L     LAB      00000000  R PUB       PROG
print_string     C L     LAB      0000000B  R PUB       PROG
print_word       C L     LAB      00000070  R PUB       PROG
word_atf0        C L     LAB      00000092  R           PROG
word_atf1        C L     LAB      000000AB  R           PROG
word_atf2        C L     LAB      000000CA  R           PROG
word_atf3        C L     LAB      000000E3  R           PROG
word_doneadd0    C L     LAB      00000095  R           PROG
word_doneadd1    C L     LAB      000000AE  R           PROG
word_doneadd2    C L     LAB      000000CD  R           PROG
word_doneadd3    C L     LAB      000000E6  R           PROG


TOTAL
  124 user defined symbol(s)
