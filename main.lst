(C)Copyright TOSHIBA CORPORATION 1993-2009  All rights reserved
Tue May 12 04:47:23 2020
TLCS-900 Relocatable Assembler (32) V2.2k  [Page     1]  main.lst
Runtime option : c:\Program Files (x86)\TOSHIBA\T900\bin\asm900.exe -Nb2 -O1 -g -l main.asm

Location  Object                           Ins        Line Source Statement

                                 +0          1           1 ;*****************************************
                                 +0          2           2 ;	Main Program 
                                 +0          3           3 ;*****************************************
                                 +0          4           4 	$MAXIMUM
                                 +0          5           5 	module game_main
                                 +0          6           6 
                                 +0          7           7 ;  ---------------------------------
                                 +0          8           8 ;	EXTERNAL LOOK UP
                                 +0          9           9 ;  ---------------------------------
                                 +0         10          10 	extern SYS_PATCH
                                 +0         11          11 	extern SYSTEM_CALL
                                 +0         12          12 	extern init_setting
                                 +0         13          13 
                                 +0         14          14 ;  ---------------------------------
                                 +0         15          15 ;   EXTERNAL DEFINITION
                                 +0         16          16 ;  ---------------------------------
                                 +0         17          17 	public reset,v_int,h_int,dummy,timer1,timer2
                                 +0         18          18 	public alarm_int,z80_int,sound_int
                                 +0         19          19 
                                 +0         20          20 ;  ---------------------------------
                                 +0         21          21 ;	INCLUDE
                                 +0         22          22 ;  ---------------------------------
                                 +0         23          23 	$include "system.inc"
                                 +1          1          24 ;-----------------------------------------------------------------
                                 +1          2          25 
                                 +1          3          26 ;	SYSTEM CALL
                                 +1          4          27 
                                 +1          5          28 ;-----------------------------------------------------------------
                                 +1          6          29 
  00000000                       +1          7          30 SYS_SUCCESS		equ	0x00			;run success
                                 +1          8          31 
  000000FF                       +1          9          32 SYS_FAILURE		equ	0xff			;run failure
                                 +1         10          33 
                                 +1         11          34 ;-----------------------------------------------------------------
                                 +1         12          35 
  00000000                       +1         13          36 VECT_SHUTDOWN		equ	0x00			;shutdown (power OFF)
                                 +1         14          37 
  00000001                       +1         15          38 VECT_CLOCKGEARSET	equ	0x01			;clock gear change
                                 +1         16          39 
  00000002                       +1         17          40 VECT_RTCGET		equ	0x02			;obtain time
                                 +1         18          41 
  00000004                       +1         19          42 VECT_INTLVSET		equ	0x04			;set interrupt level
                                 +1         20          43 
  00000005                       +1         21          44 VECT_SYSFONTSET	equ	0x05			;set system font
                                 +1         22          45 
  00000006                       +1         23          46 VECT_FLASHWRITE	equ	0x06			;flash memory data write
                                 +1         24          47 
  00000007                       +1         25          48 VECT_FLASHALLERS	equ	0x07			;flash memory erase all blocks
                                 +1         26          49 
  00000008                       +1         27          50 VECT_FLASHERS		equ	0x08			;flash memory erase specified blocks
                                 +1         28          51 
  00000009                       +1         29          52 VECT_ALARMSET		equ	0x09			;game alarm setting
                                 +1         30          53 
  0000000B                       +1         31          54 VECT_ALARMDOWNSET	equ	0x0b			;alarm setting during shutdown
                                 +1         32          55 
  0000000D                       +1         33          56 VECT_FLASHPROTECT	equ	0x0d			;protect using tool
                                 +1         34          57 
  0000000E                       +1         35          58 VECT_GEMODESET	equ	0x0e			;switching GE mode
                                 +1         36          59 
                                 +1         37          60 ;-----------------------------------------------------------------
                                 +1         38          61 
                                 +1         39          62 ;	SYSTEM BIT EQU
                                 +1         40          63 
                                 +1         41          64 ;-----------------------------------------------------------------
                                 +1         42          65 
  00000007                       +1         43          66 INT_CLR_BIT		equ	0x07			;interrupt request clear bit
                                 +1         44          67 
  00000080                       +1         45          68 _INT_CLR_BIT		equ	0y10000000		;
                                 +1         46          69 
                                 +1         47          70 ;-----------------------------------------------------------------
                                 +1         48          71 
                                 +1         49          72 ;	SYSTEM WORK
                                 +1         50          73 
                                 +1         51          74 ;-----------------------------------------------------------------
                                 +1         52          75 
  00006F80                       +1         53          76 Battery_Voltage	equ	0x6f80			;estimated voltage
                                 +1         54          77 
  00006F82                       +1         55          78 Sys_lever		equ	0x6f82			;lever value
                                 +1         56          79 
  00006F87                       +1         57          80 Language		equ	0x6f87			;language chosen
                                 +1         58          81 
  00006F85                       +1         59          82 User_Shutdown		equ	0x6f85			;shutdown re1uest bit
                                 +1         60          83 
  00006F84                       +1         61          84 User_Boot		equ	0x6f84			;startup bit flag
                                 +1         62          85 
  00006F86                       +1         63          86 User_Answer		equ	0x6f86			;user request bit
                                 +1         64          87 
  00006F91                       +1         65          88 OS_Version		equ	0x6f91			;system version reserve work
                                 +1         66          89 
                                 +1         67          90 ;-----------------------------------------------------------------
                                 +1         68          91 
                                 +1         69          92 ;	WATCH DOG
                                 +1         70          93 
                                 +1         71          94 ;-----------------------------------------------------------------
                                 +1         72          95 
  0000006F                       +1         73          96 WDCR			equ	0x06F		;watch dog control address
                                 +1         74          97 
  0000004E                       +1         75          98 WD_CLR			equ	0x04e		;watch dog clear code
                                 +1         76          99 
                                 +1         77         100 ;-----------------------------------------------------------------
                                 +1         78         101 
                                 +1         79         102 ;	SYSTEM WORK BIT
                                 +1         80         103 
                                 +1         81         104 ;-----------------------------------------------------------------
                                 +1         82         105 
                                 +1         83         106 ;======================================================= 
                                 +1         84         107 
                                 +1         85         108 ;	USER START UP BIT
                                 +1         86         109 
                                 +1         87         110 ;======================================================= 
                                 +1         88         111 
                                 +1         89         112 ;User_Boot
                                 +1         90         113 
                                 +1         91         114 ;	00000000
                                 +1         92         115 
                                 +1         93         116 ;	||+------ resume startup			0:not resume startup		1:resume startup
                                 +1         94         117 
                                 +1         95         118 ;	|+------- POWER startup			0:not POWER startup		1:POWER startup
                                 +1         96         119 
                                 +1         97         120 ;	+-------- alarm startup			0:not alarm statup		1:alarm statup
                                 +1         98         121 
                                 +1         99         122 ;	=================================================
                                 +1        100         123 
                                 +1        101         124 
                                 +1        102         125 
  00000007                       +1        103         126 ALARM_BOOT_REQ		equ	0x07
                                 +1        104         127 
  00000006                       +1        105         128 POWER_BOOT_REQ		equ	0x06
                                 +1        106         129 
  00000005                       +1        107         130 RESUME_BOOT_REQ		equ	0x05
                                 +1        108         131 
  00000080                       +1        109         132 _ALARM_BOOT_REQ		equ	0y10000000
                                 +1        110         133 
  00000040                       +1        111         134 _POWER_BOOT_REQ		equ	0y01000000
                                 +1        112         135 
  00000020                       +1        113         136 _RESUME_BOOT_REQ	equ	0y00100000
                                 +1        114         137 
                                 +1        115         138 
                                 +1        116         139 
                                 +1        117         140 ;======================================================= 
                                 +1        118         141 
                                 +1        119         142 ;	USER SHUTDOWN BIT
                                 +1        120         143 
                                 +1        121         144 ;======================================================= 
                                 +1        122         145 
                                 +1        123         146 ;User_Shutdown
                                 +1        124         147 
                                 +1        125         148 ;	00000000
                                 +1        126         149 
                                 +1        127         150 ;	||+--------- main power use shutdown request	0:no request	1:request
                                 +1        128         151 
                                 +1        129         152 ;	|+---------- no use shutdown request		0:no request	1:request
                                 +1        130         153 
                                 +1        131         154 ;	+----------- power off shutdown request		0:no request	1:request
                                 +1        132         155 
                                 +1        133         156 ;	=================================================
                                 +1        134         157 
                                 +1        135         158 
                                 +1        136         159 
  00000007                       +1        137         160 MP_SHUTDOWN_REQ	equ	0x07
                                 +1        138         161 
  00000006                       +1        139         162 TIME_SHUTDOWN_REQ	equ	0x06
                                 +1        140         163 
  00000005                       +1        141         164 BAT_SHUTDOWN_REQ	equ	0x05
                                 +1        142         165 
  00000080                       +1        143         166 _MP_SHUTDOWN_REQ	equ	0y10000000
                                 +1        144         167 
  00000040                       +1        145         168 _TIME_SHUTDOWN_REQ	equ	0y01000000
                                 +1        146         169 
  00000020                       +1        147         170 _BAT_SHUTDOWN_REQ	equ	0y00100000
                                 +1        148         171 
                                 +1        149         172 
                                 +1        150         173 
                                 +1        151         174 ;======================================================= 
                                 +1        152         175 
                                 +1        153         176 ;	USER ANSWER BIT
                                 +1        154         177 
                                 +1        155         178 ;======================================================= 
                                 +1        156         179 
                                 +1        157         180 ;User_Answer
                                 +1        158         181 
                                 +1        159         182 ;	00000000
                                 +1        160         183 
                                 +1        161         184 ;	|+----------- no use shutdown operation	0:non-existent	1:exists
                                 +1        162         185 
                                 +1        163         186 ;	+------------ resume operation		0:non-existent	1:exists
                                 +1        164         187 
                                 +1        165         188 ;	=================================================
                                 +1        166         189 
                                 +1        167         190 
                                 +1        168         191 
  00000007                       +1        169         192 RESUME_ANS		equ	0x07
                                 +1        170         193 
  00000006                       +1        171         194 TIMER_SHUTDOWN_ANS	equ	0x06
                                 +1        172         195 
  00000080                       +1        173         196 _RESUME_ANS		equ	0y10000000
                                 +1        174         197 
  00000040                       +1        175         198 _TIMER_SHUTDOWN_ANS	equ	0y01000000
                                 +1        176         199 
                                 +0         24         200 	$include "k1head.inc"
                                 +1          1         201 ;=======================================================
                                 +1          2         202 
                                 +1          3         203 ;		SYSTEM RELATED EQU
                                 +1          4         204 
                                 +1          5         205 ;=======================================================
                                 +1          6         206 
  00008000                       +1          7         207 DISP_CTL0		EQU	0x08000			;interrupt control register
                                 +1          8         208 
                                 +1          9         209 ;D7 : 1 = Vint allowed / 0 = not allowed
                                 +1         10         210 
                                 +1         11         211 ;D6 : 1 = Hint allowed / 0 = not allowed
                                 +1         12         212 
                                 +1         13         213 
                                 +1         14         214 
  00008010                       +1         15         215 STS_RG_ADD		EQU	0x08010			;2D status register (READ)
                                 +1         16         216 
                                 +1         17         217 ;D7 : 1 = character over / 0 = no character over
                                 +1         18         218 
                                 +1         19         219 ;D6 : 1 = while V blanking / 0 = while in display mode
                                 +1         20         220 
                                 +1         21         221 
                                 +1         22         222 
  00008012                       +1         23         223 LCD_CTR_ADD		EQU	0x08012			;2D control register
                                 +1         24         224 
                                 +1         25         225 ;D7 : 1 = screen color inverse display / 0 = normal display
                                 +1         26         226 
                                 +1         27         227 ;D2`D0 : outside window frame color CODE
                                 +1         28         228 
                                 +1         29         229 
                                 +1         30         230 
  00008118                       +1         31         231 BG_COLOR		EQU 0X08118			;Background color register
                                 +1         32         232 
                                 +1         33         233 ;D7`D6: BGON. D7 = 1, D6 = 0: Use specified BG color. Defaults to D7/D6 both 0
                                 +1         34         234 
                                 +1         35         235 ;D2`D0: BG color code
                                 +1         36         236 
                                 +1         37         237 
                                 +1         38         238 
                                 +1         39         239 
  000087E0                       +1         40         240 RESET_ADD		EQU	0X087E0			;2D software reset (WRITE)
                                 +1         41         241 
                                 +1         42         242 ;2D cicuit initialization with "52" write
                                 +1         43         243 
                                 +1         44         244 
                                 +1         45         245 
  000087FE                       +1         46         246 VERSION_ADD		EQU	0x087FE			;2D cicuit version (READ)
                                 +1         47         247 
                                 +1         48         248 ;D7 : 1 = white LCD panel /0 = balck LCD panel 
                                 +1         49         249 
                                 +1         50         250 ;D5`D0 : 2D circuit version
                                 +1         51         251 
                                 +1         52         252 
                                 +1         53         253 
                                 +1         54         254 
                                 +1         55         255 
                                 +1         56         256 ;=======================================================
                                 +1         57         257 
                                 +1         58         258 ;		CHARACTER EQU
                                 +1         59         259 
                                 +1         60         260 ;=======================================================
                                 +1         61         261 
  0000A000                       +1         62         262 CHR_VRAM		EQU	0x0A000			;character data RAM address
                                 +1         63         263 
                                 +1         64         264 
                                 +1         65         265 
                                 +1         66         266 
                                 +1         67         267 
                                 +1         68         268 ;=======================================================
                                 +1         69         269 
                                 +1         70         270 ;		SCROLL EQU
                                 +1         71         271 
                                 +1         72         272 ;=======================================================
                                 +1         73         273 
  00009000                       +1         74         274 SCRL1_VRAM		EQU	0x09000
                                 +1         75         275 
  00009800                       +1         76         276 SCRL2_VRAM		EQU	0x09800
                                 +1         77         277 
                                 +1         78         278 
                                 +1         79         279 
  00008030                       +1         80         280 SCRL_PRIO_ADR		EQU	0X08030			;scroll priority level invert register 
                                 +1         81         281 
  00008032                       +1         82         282 SCRL_X1_ADR		EQU	0x08032			;scroll 1 offset H register
                                 +1         83         283 
  00008033                       +1         84         284 SCRL_Y1_ADR		EQU	0x08033			;scroll 1 offset V register
                                 +1         85         285 
  00008034                       +1         86         286 SCRL_X2_ADR		EQU	0x08034			;scroll 2 offset H register
                                 +1         87         287 
  00008035                       +1         88         288 SCRL_Y2_ADR		EQU	0x08035			;scroll 2 offset V register
                                 +1         89         289 
                                 +1         90         290 
                                 +1         91         291 
                                 +1         92         292 ;=======================================================
                                 +1         93         293 
                                 +1         94         294 ;		SPRITE EQU
                                 +1         95         295 
                                 +1         96         296 ;=======================================================
                                 +1         97         297 
  00008800                       +1         98         298 SPR_VRAM		EQU	0x08800
                                 +1         99         299 
  00008020                       +1        100         300 SPR_OFFSET_X_ADR	EQU	0x08020			;sprite offset H
                                 +1        101         301 
  00008021                       +1        102         302 SPR_OFFSET_Y_ADR	EQU	0x08021			;sprite offset V
                                 +1        103         303 
                                 +1        104         304 
                                 +1        105         305 
                                 +1        106         306 
                                 +1        107         307 
                                 +1        108         308 ;=======================================================
                                 +1        109         309 
                                 +1        110         310 ;		WINDOW SYSTEM EQU
                                 +1        111         311 
                                 +1        112         312 ;=======================================================
                                 +1        113         313 
  00008002                       +1        114         314 WIN_WBAX_ADR		EQU	0x08002			;window origin H
                                 +1        115         315 
  00008003                       +1        116         316 WIN_WBAY_ADR		EQU	0x08003			;window origin V
                                 +1        117         317 
  00008004                       +1        118         318 WIN_WSIX_ADR		EQU	0x08004			;window size H
                                 +1        119         319 
  00008005                       +1        120         320 WIN_WSIY_ADR		EQU	0x08005			;window size V
                                 +1        121         321 
                                 +1        122         322 
                                 +1        123         323 
  00008008                       +1        124         324 WD_LCDST_HPOS		EQU	0x08008			;raster H position register (READ)
                                 +1        125         325 
  00008009                       +1        126         326 WD_LCDST_VPOS		EQU	0x08009			;raster V position register (READ)
                                 +1        127         327 
                                 +1        128         328 
                                 +1        129         329 
                                 +1        130         330 ;=======================================================
                                 +1        131         331 
                                 +1        132         332 ;		PALETTE EQU
                                 +1        133         333 
                                 +1        134         334 ;=======================================================
                                 +1        135         335 
                                 +1        136         336 ;sprite palette 0
                                 +1        137         337 
  00008101                       +1        138         338 PL_SPR_00		EQU	0x08101	
                                 +1        139         339 
  00008102                       +1        140         340 PL_SPR_01		EQU	0x08102
                                 +1        141         341 
  00008103                       +1        142         342 PL_SPR_02		EQU	0x08103
                                 +1        143         343 
                                 +1        144         344 ;sprite palette 1
                                 +1        145         345 
  00008105                       +1        146         346 PL_SPR_10		EQU	0x08105
                                 +1        147         347 
  00008106                       +1        148         348 PL_SPR_11		EQU	0x08106
                                 +1        149         349 
  00008107                       +1        150         350 PL_SPR_12		EQU	0x08107
                                 +1        151         351 
                                 +1        152         352 
                                 +1        153         353 
                                 +1        154         354 ;scroll 0 palette 0
                                 +1        155         355 
  00008109                       +1        156         356 PL_SCR0_00		EQU	0x08109
                                 +1        157         357 
  0000810A                       +1        158         358 PL_SCR0_01		EQU	0x0810A
                                 +1        159         359 
  0000810B                       +1        160         360 PL_SCR0_02		EQU	0x0810B
                                 +1        161         361 
                                 +1        162         362 ;scroll 0 palette 1
                                 +1        163         363 
  0000810D                       +1        164         364 PL_SCR0_10		EQU	0x0810D
                                 +1        165         365 
  0000810E                       +1        166         366 PL_SCR0_11		EQU	0x0810E
                                 +1        167         367 
  0000810F                       +1        168         368 PL_SCR0_12		EQU	0x0810F
                                 +1        169         369 
                                 +1        170         370 ;scroll 1 palette 0
                                 +1        171         371 
  00008111                       +1        172         372 PAL_SCR1_00		EQU	0x08111
                                 +1        173         373 
  00008112                       +1        174         374 PAL_SCR1_01		EQU	0x08112
                                 +1        175         375 
  00008113                       +1        176         376 PAL_SCR1_02		EQU	0x08113
                                 +1        177         377 
                                 +1        178         378 ;scroll 1 palette 1
                                 +1        179         379 
  00008115                       +1        180         380 PAL_SCR1_10		EQU	0x08115
                                 +1        181         381 
  00008116                       +1        182         382 PAL_SCR1_11		EQU	0x08116
                                 +1        183         383 
  00008117                       +1        184         384 PAL_SCR1_12		EQU	0x08117
                                 +1        185         385 
                                 +1        186         386 
                                 +1        187         387 ;=======================================================
                                 +1        188         388 
                                 +1        189         389 ;		COLOR PALETTE RAM EQU
                                 +1        190         390 
                                 +1        191         391 ;=======================================================
                                 +1        192         392 
  00008200                       +1        193         393 SPRITE_CRAM		EQU 0x08200
                                 +1        194         394 
  00008280                       +1        195         395 SCROLL1_CRAM	EQU 0x08280
                                 +1        196         396 
  00008300                       +1        197         397 SCROLL2_CRAM	EQU 0x08300
                                 +1        198         398 
  000083E0                       +1        199         399 BGCOL_CRAM		EQU 0x083E0 ;for the background color
                                 +1        200         400 
  000083F0                       +1        201         401 WINDOW_CRAM		EQU 0x083F0
                                 +1        202         402 
                                 +1        203         403 
                                 +1        204         404 ;=======================================================
                                 +1        205         405 
                                 +1        206         406 
                                 +1        207         407 
                                 +0         25         408 	$include "glbwork.inc"
                                 +1          1         409 ;================================================================
                                 +1          2         410 ; global vars
                                 +1          3         411 ;================================================================
                                 +1          4         412 
                                 +1          5         413 	extern medium start_work
                                 +1          6         414 	extern medium stopper
                                 +1          7         415 	extern medium frame_cnt
                                 +1          8         416 
                                 +1          9         417 ;================================================================
                                 +1         10         418 
                                 +0         26         419 	$include "game.inc"
                                 +1          1         420 ;================================================================
                                 +1          2         421 ; GAME EQU
                                 +1          3         422 ;================================================================
                                 +1          4         423 
  000000A0                       +1          5         424 disp_size_x		EQU	160		; X screen size
                                 +1          6         425 
  00000098                       +1          7         426 disp_size_y		EQU	152		; Y screen size
                                 +1          8         427 
  00000040                       +1          9         428 obj_max		EQU	64		; number of maximum sprites
                                 +1         10         429 
                                 +1         11         430 ;================================================================
                                 +1         12         431 
                                 +0         27         432 	$include "print.inc"
                                 +1          1         433 ;*****************************************
                                 +1          2         434 ;	Print functions 
                                 +1          3         435 ;*****************************************
                                 +1          4         436 
                                 +1          5         437 ;-------------------------------------------------------
                                 +1          6         438 ; print_init: loads system font into first half of vram
                                 +1          7         439 ;-------------------------------------------------------
                                 +1          8         440 	extern print_init
                                 +1          9         441 
                                 +1         10         442 ;-------------------------------------------------------
                                 +1         11         443 ; print_string
                                 +1         12         444 ;-------------------------------------------------------
                                 +1         13         445 ; xix: pointer to null terminated text
                                 +1         14         446 ; wa: x pos
                                 +1         15         447 ; bc: y pos
                                 +1         16         448 ;-------------------------------------------------------
                                 +1         17         449 	extern print_string
                                 +1         18         450 	
                                 +1         19         451 ;-------------------------------------------------------
                                 +1         20         452 ; print_byte
                                 +1         21         453 ;-------------------------------------------------------
                                 +1         22         454 ; xix: pointer to byte to print
                                 +1         23         455 ; wa: x pos
                                 +1         24         456 ; bc: y pos
                                 +1         25         457 ;-------------------------------------------------------
                                 +1         26         458 	extern print_byte
                                 +1         27         459 	
                                 +1         28         460 ;-------------------------------------------------------
                                 +1         29         461 ; print_word	
                                 +1         30         462 ;-------------------------------------------------------
                                 +1         31         463 ; xix: pointer to word to print
                                 +1         32         464 ; wa: x pos
                                 +1         33         465 ; bc: y pos
                                 +1         34         466 ;-------------------------------------------------------
                                 +1         35         467 	extern print_word
                                 +0         28         468 	$include "graphics.inc"
                                 +1          1         469 ;*****************************************
                                 +1          2         470 ;	Graphics data 
                                 +1          3         471 ;*****************************************
                                 +1          4         472 
                                 +1          5         473 	extern palette
                                 +1          6         474 	extern palette_end
                                 +1          7         475 	extern tiles
                                 +1          8         476 	extern tiles_end
                                 +1          9         477 	; extern map
                                 +1         10         478 	; extern map_end
                                 +0         29         479 
                                 +0         30         480 
                                 +0         31         481 ;-------------------------------------------------------
                                 +0         32         482 PROG section code large
                                 +0         33         483 ;-------------------------------------------------------
                                 +0         34         484 
                                 +0         35         485 		public	__STARTUP
  00FF1800                       +0         36         486 __STARTUP	equ	0xff1800
                                 +0         37         487 ;-------------------------------------------------------
                                 +0         38         488 ; entry point			
                                 +0         39         489 ;-------------------------------------------------------
00000000                         +0         40         490 reset:
00000000  1D000000             R +0         41         491 	cal	SYS_PATCH ;called during init to assist with power functionality
                                 +0         42         492 
                                 +0         43         493 ;------------------- INITIALIZATION --------------------
00000004  1D000000             R +0         44         494 	cal init_setting ;VRAM, work initialization
                                 +0         45         495 	; cal print_init ;load system font
00000008  0600                   +0         46         496 	ei 0 ;allow interrupts with a priority >= 0
                                 +0         47         497 	
                                 +0         48         498 	
                                 +0         49         499 	
0000000A  F200000035           R +0         50         500 	lda xiy,palette
0000000F  F1828234               +0         51         501 	lda xix,SCROLL1_CRAM+2
00000013  D200000021           R +0         52         502 	ldw bc,(palette_end-palette)
00000018  8511                   +0         53         503 	ldir (xix+),(xiy+)
                                 +0         54         504 	
                                 +0         55         505 	
                                 +0         56         506 	; lda xix,SCROLL1_CRAM
                                 +0         57         507 	; ldw (xix+),0xfff
                                 +0         58         508 	; ldw (xix+),0x000
                                 +0         59         509 	; ldw (xix+),0x000
                                 +0         60         510 	; ldw (xix+),0x00f
                                 +0         61         511 	
0000001A  F200000035           R +0         62         512 	lda xiy,tiles
0000001F  F100A034               +0         63         513 	lda xix,CHR_VRAM
00000023  D200000021           R +0         64         514 	ldw bc,(tiles_end-tiles)
00000028  8511                   +0         65         515 	ldir (xix+),(xiy+)
                                 +0         66         516 	
                                 +0         67         517 	; lda xiy,map
                                 +0         68         518 	; lda xix,SCRL1_VRAM
                                 +0         69         519 	; ldw bc,(map_end-map)
                                 +0         70         520 	; ldir (xix+),(xiy+)
                                 +0         71         521 	
0000002A  F1009034               +0         72         522 	lda xix,SCRL1_VRAM
0000002E  D8A8                   +0         73         523 	ldw wa,0
00000030  2313                   +0         74         524 	ldb c,19
00000032                         +0         75         525 map_copy_y:
00000032  2214                   +0         76         526 	ldb b,20
00000034                         +0         77         527 map_copy_x:
00000034  F5F150                 +0         78         528 	ldw (xix+),wa
00000037  D861                   +0         79         529 	incw 1,wa
00000039  CA1CF8                 +0         80         530 	djnz b,map_copy_x
0000003C  ECCCC0FF0000           +0         81         531 	andl xix,0xffc0
00000042  ECC840000000           +0         82         532 	addl xix,0x40
00000048  CB1CE7                 +0         83         533 	djnz c,map_copy_y
                                 +0         84         534 	
                                 +0         85         535 ;-------------------------------------------------------
                                 +0         86         536 ; main loop
                                 +0         87         537 ;-------------------------------------------------------
0000004B                         +0         88         538 main:
0000004B  C100003F00           R +0         89         539 	cpb (stopper),0 ;spin until vblank resets var
00000050  66F9                   +0         90         540 	j z,main
                                 +0         91         541 
00000052  C1856F3F00             +0         92         542 	cpb (User_Shutdown),0 ;turn off the system if we get a shutdown req
00000057  6607                   +0         93         543 	j eq,main_100
                                 +0         94         544 
00000059  C731A8                 +0         95         545 	ldb rw3,VECT_SHUTDOWN
0000005C  1D000000             R +0         96         546 	cal SYSTEM_CALL
                                 +0         97         547 
00000060                         +0         98         548 main_100:
                                 +0         99         549 	; ldw wa,3 ;x pos
                                 +0        100         550 	; ldw bc,4 ;y pos
                                 +0        101         551 	; lda xix,String	
                                 +0        102         552 	; cal print_string
                                 +0        103         553 	
                                 +0        104         554 	; ldw wa,0 ;x pos
                                 +0        105         555 	; ldw bc,6 ;y pos
                                 +0        106         556 	; lda xix,JoyStr	
                                 +0        107         557 	; cal print_string
                                 +0        108         558 	
                                 +0        109         559 	; ldw wa,8
                                 +0        110         560 	; ldw bc,6
                                 +0        111         561 	; lda xix,Sys_lever
                                 +0        112         562 	; cal print_byte
                                 +0        113         563 	
                                 +0        114         564 	; ldw wa,0 ;x pos
                                 +0        115         565 	; ldw bc,7 ;y pos
                                 +0        116         566 	; lda xix,FrameStr	
                                 +0        117         567 	; cal print_string	
                                 +0        118         568 	
                                 +0        119         569 	; incw 1,(frame_cnt)
                                 +0        120         570 	; ldw wa,7
                                 +0        121         571 	; ldw bc,7
                                 +0        122         572 	; lda xix,frame_cnt
                                 +0        123         573 	; cal print_word
                                 +0        124         574 	
00000060  F100000000           R +0        125         575 	ldb (stopper),0
00000065  68E4                   +0        126         576 	j main
                                 +0        127         577 	
00000067                         +0        128         578 String:
00000067  68656C6C6F20776F726C   +0        129         579 	db "hello world",0
          6400                                             
00000073                         +0        130         580 	align 2
00000074                         +0        131         581 JoyStr:
00000074  6A6F797061643A207878   +0        132         582 	db "joypad: xx",0
          00                                               
0000007F                         +0        133         583 	align 2
00000080                         +0        134         584 FrameStr:
00000080  6672616D653A20787878   +0        135         585 	db "frame: xxxx",0
          7800                                             
0000008C                         +0        136         586 	align 2
                                 +0        137         587 	
                                 +0        138         588 ;-------------------------------------------------------
                                 +0        139         589 ; v-blank interrupt
                                 +0        140         590 ;-------------------------------------------------------
0000008C                         +0        141         591 v_int:
0000008C  3C                     +0        142         592 	pushl xix
0000008D  3D                     +0        143         593 	pushl xiy
0000008E  3E                     +0        144         594 	pushl xiz
0000008F  38                     +0        145         595 	pushl xwa
00000090  39                     +0        146         596 	pushl xbc
00000091  3A                     +0        147         597 	pushl xde
00000092  3B                     +0        148         598 	pushl xhl
00000093  02                     +0        149         599 	pushw sr
                                 +0        150         600 ;	--------------------------------
00000094  086F4E                 +0        151         601 	ldb	(WDCR),WD_CLR ;watch dog clear
00000097  F1000000FF           R +0        152         602 	ldb	(stopper),0xff
                                 +0        153         603 ;	--------------------------------
0000009C  03                     +0        154         604     popw sr
0000009D  5B                     +0        155         605 	popl xhl
0000009E  5A                     +0        156         606 	popl xde
0000009F  59                     +0        157         607 	popl xbc
000000A0  58                     +0        158         608 	popl xwa
000000A1  5E                     +0        159         609 	popl xiz
000000A2  5D                     +0        160         610 	popl xiy
000000A3  5C                     +0        161         611 	popl xix
                                 +0        162         612 
000000A4  07                     +0        163         613 	reti
                                 +0        164         614 
                                 +0        165         615 ;-------------------------------------------------------
                                 +0        166         616 ; other interrupts
                                 +0        167         617 ;-------------------------------------------------------
000000A5                         +0        168         618 h_int:
000000A5  07                     +0        169         619 	reti
                                 +0        170         620 
000000A6                         +0        171         621 timer1:
000000A6  07                     +0        172         622 	reti
                                 +0        173         623 
000000A7                         +0        174         624 timer2:
000000A7  07                     +0        175         625 	reti
                                 +0        176         626 
000000A8                         +0        177         627 alarm_int:
000000A8  07                     +0        178         628 	reti
                                 +0        179         629 
000000A9                         +0        180         630 z80_int:
000000A9  07                     +0        181         631 	reti
                                 +0        182         632 
000000AA                         +0        183         633 sound_int:
000000AA  07                     +0        184         634 	reti
                                 +0        185         635 
000000AB                         +0        186         636 dummy:
000000AB  07                     +0        187         637 	reti
                                 +0        188         638 
                                 +0        189         639 ;-------------------------------------------------------
                                 +0        190         640 	end
                                 +0        191         641 ;-------------------------------------------------------

Assembly complete, No error
TLCS-900 Relocatable Assembler (32) V2.2k  [Page     2]  main.lst

Symbol table listing
--------------------

Symbol           Category         Value     Attribute

ALARM_BOOT_REQ           NUM      00000007  A           
BAT_SHUTDOWN_REQ
                         NUM      00000005  A           
BGCOL_CRAM               NUM      000083E0  A           
BG_COLOR                 NUM      00008118  A           
Battery_Voltage          NUM      00006F80  A           
CHR_VRAM                 NUM      0000A000  A           
DISP_CTL0                NUM      00008000  A           
FrameStr         C L     LAB      00000080  R           PROG
INT_CLR_BIT              NUM      00000007  A           
JoyStr           C L     LAB      00000074  R           PROG
LCD_CTR_ADD              NUM      00008012  A           
Language                 NUM      00006F87  A           
MP_SHUTDOWN_REQ          NUM      00000007  A           
OS_Version               NUM      00006F91  A           
PAL_SCR1_00              NUM      00008111  A           
PAL_SCR1_01              NUM      00008112  A           
PAL_SCR1_02              NUM      00008113  A           
PAL_SCR1_10              NUM      00008115  A           
PAL_SCR1_11              NUM      00008116  A           
PAL_SCR1_12              NUM      00008117  A           
PL_SCR0_00               NUM      00008109  A           
PL_SCR0_01               NUM      0000810A  A           
PL_SCR0_02               NUM      0000810B  A           
PL_SCR0_10               NUM      0000810D  A           
PL_SCR0_11               NUM      0000810E  A           
PL_SCR0_12               NUM      0000810F  A           
PL_SPR_00                NUM      00008101  A           
PL_SPR_01                NUM      00008102  A           
PL_SPR_02                NUM      00008103  A           
PL_SPR_10                NUM      00008105  A           
PL_SPR_11                NUM      00008106  A           
PL_SPR_12                NUM      00008107  A           
POWER_BOOT_REQ           NUM      00000006  A           
PROG             C L     SEC      00000000  R AC        
RESET_ADD                NUM      000087E0  A           
RESUME_ANS               NUM      00000007  A           
RESUME_BOOT_REQ          NUM      00000005  A           
SCRL1_VRAM               NUM      00009000  A           
SCRL2_VRAM               NUM      00009800  A           
SCRL_PRIO_ADR            NUM      00008030  A           
SCRL_X1_ADR              NUM      00008032  A           
SCRL_X2_ADR              NUM      00008034  A           
SCRL_Y1_ADR              NUM      00008033  A           
SCRL_Y2_ADR              NUM      00008035  A           
SCROLL1_CRAM             NUM      00008280  A           
SCROLL2_CRAM             NUM      00008300  A           
SPRITE_CRAM              NUM      00008200  A           
SPR_OFFSET_X_ADR
                         NUM      00008020  A           
SPR_OFFSET_Y_ADR
                         NUM      00008021  A           
SPR_VRAM                 NUM      00008800  A           
STS_RG_ADD               NUM      00008010  A           
SYSTEM_CALL                       00000000  R EXT       
SYS_FAILURE              NUM      000000FF  A           
SYS_PATCH                         00000000  R EXT       
SYS_SUCCESS              NUM      00000000  A           
String           C L     LAB      00000067  R           PROG
Sys_lever                NUM      00006F82  A           
TIMER_SHUTDOWN_ANS
                         NUM      00000006  A           
TIME_SHUTDOWN_REQ
                         NUM      00000006  A           
User_Answer              NUM      00006F86  A           
User_Boot                NUM      00006F84  A           
User_Shutdown            NUM      00006F85  A           
VECT_ALARMDOWNSET
                         NUM      0000000B  A           
VECT_ALARMSET            NUM      00000009  A           
VECT_CLOCKGEARSET
                         NUM      00000001  A           
VECT_FLASHALLERS
                         NUM      00000007  A           
VECT_FLASHERS            NUM      00000008  A           
VECT_FLASHPROTECT
                         NUM      0000000D  A           
VECT_FLASHWRITE          NUM      00000006  A           
VECT_GEMODESET           NUM      0000000E  A           
VECT_INTLVSET            NUM      00000004  A           
VECT_RTCGET              NUM      00000002  A           
VECT_SHUTDOWN            NUM      00000000  A           
VECT_SYSFONTSET          NUM      00000005  A           
VERSION_ADD              NUM      000087FE  A           
WDCR                     NUM      0000006F  A           
WD_CLR                   NUM      0000004E  A           
WD_LCDST_HPOS            NUM      00008008  A           
WD_LCDST_VPOS            NUM      00008009  A           
WINDOW_CRAM              NUM      000083F0  A           
WIN_WBAX_ADR             NUM      00008002  A           
WIN_WBAY_ADR             NUM      00008003  A           
WIN_WSIX_ADR             NUM      00008004  A           
WIN_WSIY_ADR             NUM      00008005  A           
_ALARM_BOOT_REQ          NUM      00000080  A           
_BAT_SHUTDOWN_REQ
                         NUM      00000020  A           
_INT_CLR_BIT             NUM      00000080  A           
_MP_SHUTDOWN_REQ
                         NUM      00000080  A           
_POWER_BOOT_REQ          NUM      00000040  A           
_RESUME_ANS              NUM      00000080  A           
_RESUME_BOOT_REQ
                         NUM      00000020  A           
_TIMER_SHUTDOWN_ANS
                         NUM      00000040  A           
_TIME_SHUTDOWN_REQ
                         NUM      00000040  A           
__STARTUP                NUM      00FF1800  A PUB       
alarm_int        C L     LAB      000000A8  R PUB       PROG
disp_size_x              NUM      000000A0  A           
disp_size_y              NUM      00000098  A           
dummy            C L     LAB      000000AB  R PUB       PROG
game_main                MOD
h_int            C L     LAB      000000A5  R PUB       PROG
init_setting                      00000000  R EXT       
main             C L     LAB      0000004B  R           PROG
main_100         C L     LAB      00000060  R           PROG
map_copy_x       C L     LAB      00000034  R           PROG
map_copy_y       C L     LAB      00000032  R           PROG
obj_max                  NUM      00000040  A           
palette                           00000000  R EXT       
palette_end                       00000000  R EXT       
reset            C L     LAB      00000000  R PUB       PROG
sound_int        C L     LAB      000000AA  R PUB       PROG
stopper                           00000000  R EXT       
tiles                             00000000  R EXT       
tiles_end                         00000000  R EXT       
timer1           C L     LAB      000000A6  R PUB       PROG
timer2           C L     LAB      000000A7  R PUB       PROG
v_int            C L     LAB      0000008C  R PUB       PROG
z80_int          C L     LAB      000000A9  R PUB       PROG


TOTAL
  117 user defined symbol(s)
    6 unreferenced external symbol(s)
